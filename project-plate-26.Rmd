---
title: Microbiome variability project refset evaluation (MiSeq plate 26)
author: Noah Hoffman
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  html_document:
    toc: true
---

# changes

* 2017-10-17 - version sent to Sujatha
* 2017-10-19 - include notes from review with Sujatha
* 2017-10-26 - include results with urogenital-2017-10-23_named-1.0.refpkg

# original list of taxa for follow up

In tallies_wide.species-2017-10-03.xlsx, from email from Sujatha 10/6/2017:

```{css}
pre {
    overflow-x: auto;
}
pre code {
    overflow-wrap: normal;
    white-space: pre;
}
```

```
| tax_name                                            | tax_id        | rank        | Questions                                       | Notes      |
| --------------------------------------------------- | ------------- | ----------- | ----------------------------------------------- | ---------- |
| Peptoniphilus grossensis/harei                      | 146575654005  | species     | Can we distinguish or not - true placement?     |            |
| Lactobacillus reuteri/vaginalis                     | 15981633      | species     | Can we distinguish or not - true placement?     |            |
| Corynebacterium pseudogenitalium/tuberculostearicum | 3830338304    | species     | Can we distinguish or not - true placement?     |            |
| Staphylococcus capitis/epidermidis                  | 128229388     | species     | Can we distinguish or not - true placement?     | Likely not |
| Ureaplasma parvum/urealyticum                       | 1348212130    | species     | Can we distinguish or not - true placement?     |            |
| Anaerococcus prevotii/tetradius                     | 3303433036    | species     | Can we distinguish or not - true placement?     |            |
| Gemella haemolysans/sanguinis                       | 137984135     | species     | Can we distinguish or not - true placement?     |            |
| Fenollaria massiliensis/timonensis                  | 1723384938288 | species     | Can we distinguish or not - true placement?     |            |
| Megasphaera                                         | 906           | genus       | Speciate?                                       |            |
| Ureaplasma                                          | 2129          | genus       | Speciate?                                       |            |
| unclassified Bacteroidales                          | 333046        | below_order | Speciate?                                       |            |
| Streptococcus                                       | 1301          | genus       | Speciate?                                       |            |
| Prevotella                                          | 838           | genus       | Speciate?                                       |            |
| Arcanobacterium                                     | 28263         | genus       | Speciate?                                       |            |
| Bulleidia                                           | 118747        | genus       | Speciate?                                       |            |
| Lawsonella                                          | 1847725       | genus       | Speciate?                                       |            |
| Howardella                                          | 404402        | genus       | Speciate?                                       |            |
| Lactobacillus acidophilus                           | 1579          | species     | True placement? How different from L. crispatus |            |
| Lactobacillus helveticus                            | 1587          | species     | True placement? How different from L. crispatus |            |
| Proteobacteria                                      | 1224          | phylum      | What's this?                                    |            |
```

# comparison between refsets

```{r}
first <- read.csv('output-2017-09-14/multiclass_concat.csv', as.is=TRUE)
second <- read.csv('output-2017-10-26/multiclass_concat.csv', as.is=TRUE)
```

```{r results='asis'}
cols <- c('name', 'tax_name', 'abundance', 'rank')
versions <- c('2017-09-14', '2017-10-26')
data <- list(first, second)
stacked <- do.call(rbind, lapply(seq_along(data), function(i){
  x <- data[[i]][,cols]
  x$version <- versions[i]
  x
}))
stacked$name <- sapply(strsplit(stacked$name, split=':'), '[', 1)
stacked <- stacked[order(stacked$name),]

classifications <- tidyr::spread(stacked[, c('name', 'version', 'tax_name')], version, tax_name)
abundance <- with(first, setNames(abundance, sapply(strsplit(name, split=':'), '[', 1)))
classifications$abundance <- abundance[classifications$name]
```

All differing classifications

```{r}
differing <- sapply(apply(classifications[,versions], 1, unique), length) > 1
## knitr::kable(classifications[differing & (classifications$abundance > 500),])
knitr::kable(classifications[differing,])
```

Write the full comparison to a file

```{r}
# write.csv(classifications, file='full-comparison.csv', row.names=FALSE)
```

Function to display classifications

```{r}
list_matching <- function(name, version=versions[1]){
  show <- grepl(gettextf('^%s$', name), as.character(classifications[[version]]))
  if(!any(show)){
    cat('no matches\n')
  }else{
    knitr::kable(classifications[show,])
  }
}
```

Bash functions for showing alignments

```
alnall(){av $1/combined.aln.fasta -L 500 | less -S}
aln(){av $1/combined.aln.fasta -r ${2-360,810} -x --simchar . -n 150 -w 200 -L 500 | less -S}
trim_to(){av $1/combined.aln.fasta -R $2 -x --simchar . -n 150 -w 200 -L 500 | less -S}
```

## Peptoniphilus grossensis/harei

```{r results='asis'}
list_matching('Peptoniphilus grossensis/harei')
```

![Peptoniphilus grossensis/harei sing tree](figs/2017-09-14/peptoniphilus_grossensis_harei.png)

```
% av output-gethits-2017-09-14/species/Peptoniphilus_grossensis_harei/combined.aln.fasta -R sv_043 -x -n 100 | less -S
                                                                                                   # 00
                                                                                                   # 45
                                                                                                   # 29
                                                                                                   # 94
Peptoniphilus_grossensis_strain_35_6_1_unitig_0_whole_genome_shotgun_sequence|NZ_MJIH01000001_945367 AG
Peptoniphilus_grossensis_strain_35_6_1_unitig_0_whole_genome_shotgun_sequence|NZ_MJIH01000001_596977 AG
Peptoniphilus_grossensis_strain_35_6_1_unitig_0_whole_genome_shotgun_sequence|NZ_MJIH01000001_775304 AG
        Peptoniphilus_harei_partial_16S_rRNA_gene_isolate_TID_12|LN871839_1_1475|LN871839|taxid54005 AG
Peptoniphilus_harei_strain_DSM_10020_16S_ribosomal_RNA_gene_partial_sequence|NR_026358_1_1476|NR_026 ta
Peptoniphilus_harei_strain_CMW7756A_genomic_scaffold_Scaffold12_whole_genome_shotgun_sequence|NZ_KQ9 AG
                                            sv_043_m26n706_s503|12354|Peptoniphilus_grossensis_harei AG
```

Indistinguishable

## Lactobacillus reuteri/vaginalis

```{r results='asis'}
list_matching('Lactobacillus reuteri/vaginalis')
```

![Lactobacillus reuteri/vaginalis tog tree](figs/2017-09-14/lactobacillus_reuteri_vaginalis.png)

![Lactobacillus reuteri/vaginalis sing tree for sv-053](figs/2017-09-14/lactobacillus_reuteri_vaginalis_sv_.png)

```
av output-gethits-2017-09-14/species/Lactobacillus_reuteri_vaginalis/combined.aln.fasta -r 387,825 --simchar . -x -n 50
```

```
                                                 # 000000000
                                                 # 444455666
                                                 # 299901026
                                                 # 801291656
Lactobacillus_reuteri_gene_for_16S_ribosomal_RNA_p .........
Lactobacillus_reuteri_strain_ZJ620_16S_ribosomal_R .........
Lactobacillus_reuteri_strain_BR11_16S_ribosomal_RN .ATCGT...
Lactobacillus_reuteri_TD1_complete_genome|CP006603 .........
Lactobacillus_reuteri_strain_LMG_18238_16S_ribosom .........
Lactobacillus_vaginalis_strain_SR8_16S_ribosomal_R .........
Lactobacillus_vaginalis_gene_for_16S_ribosomal_RNA .........
Lactobacillus_vaginalis_gene_for_16S_ribosomal_RNA ........G
Lactobacillus_vaginalis_strain_m19_16S_ribosomal_R ........G
Lactobacillus_vaginalis_strain_DoxG3_16S_ribosomal ........G
sv_045_m26n705_s502|11367|Lactobacillus_reuteri_va .........
sv_053_m26n705_s502|5955|Lactobacillus_reuteri_vag A........
sv_088_m26n715_s506|1585|Lactobacillus_reuteri_vag .......A.
sv_096_m26n715_s506|960|Lactobacillus_reuteri_vagi ......G..
```

Even though L vaginalis and reuteri appear in distinct clades, they
are indistinguishable in the sequences region.

## Corynebacterium pseudogenitalium/tuberculostearicum

```{r results='asis'}
list_matching('Corynebacterium pseudogenitalium/tuberculostearicum')
```

![Corynebacterium pseudogenitalium/tuberculostearicum](figs/2017-09-14/corynebacterium_pseudogenitalium_tuberculostearicum.png)

These are indistinguishable

## Staphylococcus capitis/epidermidis

```{r results='asis'}
list_matching('Staphylococcus capitis/epidermidis')
```

```
% av output-gethits-2017-09-14/species/Staphylococcus_capitis_epidermidis/combined.aln.fasta -r 364,802 -x --simchar . -n 150 -w 200 | less -S
                                                                                                                                # 000000000
                                                                                                                                # 444456677
                                                                                                                                # 266605678
                                                                                                                                # 368937287
         Staphylococcus_epidermidis_strain_EHFS1_S17Hb_16S_ribosomal_RNA_gene_partial_sequence|EU071611_1_1415|EU071611|taxid1282 .....N.N.
                 Staphylococcus_epidermidis_strain_L33_16S_ribosomal_RNA_gene_partial_sequence|KU922295_1_1410|KU922295|taxid1282 ........T
            Staphylococcus_epidermidis_strain_m030608b_16S_ribosomal_RNA_gene_partial_sequence|HM216570_1_1227|HM216570|taxid1282 .........
               Staphylococcus_epidermidis_strain_W_3_4_16S_ribosomal_RNA_gene_partial_sequence|KJ438691_1_1497|KJ438691|taxid1282 .........
                 Staphylococcus_epidermidis_strain_14F_16S_ribosomal_RNA_gene_partial_sequence|KC329827_1_1515|KC329827|taxid1282 .TCA.....
                 Staphylococcus_capitis_strain_Sc_C81_16S_ribosomal_RNA_gene_partial_sequence|KR149341_1_1462|KR149341|taxid29388 A...-.-..
                    Staphylococcus_capitis_strain_CH1_16S_ribosomal_RNA_gene_partial_sequence|KX784917_1_1465|KX784917|taxid29388 A........
Staphylococcus_capitis_subsp_capitis_strain_MER_TA_23_16S_ribosomal_RNA_gene_partial_sequence|KT719429_1_1443|KT719429|taxid72758 .........
                Staphylococcus_capitis_strain_BBEC_1d_16S_ribosomal_RNA_gene_partial_sequence|FJ357580_1_1439|FJ357580|taxid29388 A........
           Staphylococcus_capitis_subsp_capitis_strain_AYP1020_complete_genome|NZ_CP007601_1167713_1169268|NZ_CP007601|taxid72758 A........
                                                                      sv_060_m26n701_s505|4783|Staphylococcus_capitis_epidermidis .........
```

sv_060 may be more likely to be S epidermidis given the SNP at
position 423, but it's a tough call.

## Ureaplasma parvum/urealyticum

```{r results='asis'}
list_matching('Ureaplasma parvum/urealyticum')
```

```
% av output-gethits-2017-09-14/species/Ureaplasma_parvum_urealyticum/combined.aln.fasta -r 364,802 -x --simchar . -n 150 -w 200 | less -S
                                                                                                                                                     # 000000
                                                                                                                                                     # 345556
                                                                                                                                                     # 979995
                                                                                                                                                     # 225692
  Ureaplasma_parvum_serovar_14_str_ATCC_33697_gcontig_1106438328058_whole_genome_shotgun_sequence|NZ_ABER01000003_116_1652|NZ_ABER01000003|taxid515609 ......
                                             Ureaplasma_parvum_serovar_3_str_ATCC_700970_complete_genome|NC_002162_343913_345449|NC_002162|taxid273119 .A....
                                             Ureaplasma_parvum_serovar_3_str_ATCC_700970_complete_genome|NC_002162_145327_146863|NC_002162|taxid273119 ......
                                                        Ureaplasma_parvum_strain_hebnu3h07_complete_genome|CP021989_200848_202384|CP021989|taxid134821 .A....
Ureaplasma_parvum_serovar_6_str_ATCC_27818_gcontig_1105428157138_whole_genome_shotgun_sequence|NZ_AAZQ01000001_581612_583111|NZ_AAZQ01000001|taxid5198 ......
                                                           Ureaplasma_urealyticum_U26_serovar_14_16S_ribosomal_RNA_gene|U06095_1_1438|U06095|taxid2130 .A..-.
Ureaplasma_urealyticum_serovar_5_str_ATCC_27817_gcontig_1105469453570_whole_genome_shotgun_sequence|NZ_AAZR01000004_76708_78238|NZ_AAZR01000004|taxid5 ..-A.-
                                                              Ureaplasma_urealyticum_7_serovar_1_16S_ribosomal_RNA_gene|U06094_1_1439|U06094|taxid2130 .A....
                                                                               Ureaplasma_urealyticum_16S_ribosomal_RNA|L08642_1_1585|L08642|taxid2130 ......
                                        Ureaplasma_urealyticum_serovar_10_str_ATCC_33699_complete_genome|NC_011374_149403_150935|NC_011374|taxid565575 A.....
                                                                                                sv_050_m26n706_s503|8351|Ureaplasma_parvum_urealyticum ......
```

Indistinguishable

## Anaerococcus prevotii/tetradius

```{r results='asis'}
list_matching('Anaerococcus prevotii/tetradius')
```

```
% aln output-gethits-2017-09-14/species/Anaerococcus_prevotii_tetradius 368,780
                                                                                                                                          # 0000000000
                                                                                                                                          # 3445555666
                                                                                                                                          # 9582339123
                                                                                                                                          # 6429235915
                            Anaerococcus_tetradius_strain_F0127_16S_ribosomal_RNA_gene_partial_sequence|GQ422749_1_1501|GQ422749|taxid33036 ........-.
Anaerococcus_tetradius_strain_MJR8151_genomic_scaffold_Scaffold335_whole_genome_shotgun_sequence|NZ_KQ955310_49_1577|NZ_KQ955310|taxid33036 ........-.
                     Anaerococcus_tetradius_gene_for_16S_ribosomal_RNA_partial_sequence_strain_JCM_1964|LC036320_1_1487|LC036320|taxid33036 ........-.
                       Anaerococcus_tetradius_strain_CCUG_46590_16S_ribosomal_RNA_gene_partial_sequence|AF542234_1_1418|AF542234|taxid33036 ........-.
 Anaerococcus_tetradius_ATCC_35098_genomic_scaffold_SCAFFOLD7_whole_genome_shotgun_sequence|NZ_GG666301_63379_64908|NZ_GG666301|taxid525255 ........-.
                       Anaerococcus_prevotii_gene_for_16S_ribosomal_RNA_partial_sequence_isolate_GIFU_7658|D14139_1_1375|D14139|taxid525919 .C.GGGT-A.
                      Anaerococcus_prevotii_gene_for_16S_ribosomal_RNA_partial_sequence_strain_JCM_6490|AB558162_1_1427|AB558162|taxid33034 C.......-.
                                              Anaerococcus_prevotii_DSM_20548_complete_genome|NC_013171_235843_237373|NC_013171|taxid525919 ..T.....-T
                      Anaerococcus_prevotii_gene_for_16S_ribosomal_RNA_partial_sequence_strain_JCM_6508|AB971807_1_1488|AB971807|taxid33034 ........-.
                       Anaerococcus_prevotii_strain_CCUG_41932_16S_ribosomal_RNA_gene_partial_sequence|AF542232_1_1381|AF542232|taxid525919 ........-.
                                                                                  sv_017_m26n703_s505|56692|Anaerococcus_prevotii_tetradius ........-.
```

Indistinguishable

DONE: remove D14139 from blast database (old record, many subs relative to others)

## Gemella haemolysans/sanguinis

```{r results='asis'}
list_matching('Gemella haemolysans/sanguinis')
```

```
% aln output-gethits-2017-09-14/species/Gemella_haemolysans_sanguinis 366,818
                                                                                                                                 # 0000000000000000000000000000
                                                                                                                                 # 4444455555555555566667777777
                                                                                                                                 # 6778801235667777946990112235
                                                                                                                                 # 5135759299061789882391092991
                     Gemella_haemolysans_strain_GumJ21A_16S_ribosomal_RNA_gene_partial_sequence|GU561408_1_1297|GU561408|taxid1379 .....C-------A-------------G
Gemella_haemolysans_ATCC_10379_ctg1119035638548_whole_genome_shotgun_sequence|NZ_ACDZ02000012_336_1896|NZ_ACDZ02000012|taxid546270 .........-..-...------------
                   Gemella_haemolysans_strain_NTUH_1465_16S_ribosomal_RNA_gene_partial_sequence|HM103931_1_1397|HM103931|taxid1379 .A..T....-..-...------------
                                      Gemella_haemolysans_partial_16S_rRNA_gene_clone_S15A_MN66|AJ534689_1_1488|AJ534689|taxid1379 .........-..-...-GTG-TCACAGG
Gemella_haemolysans_M341_genomic_scaffold_supercont1_6_whole_genome_shotgun_sequence|NZ_GL883587_3994_5528|NZ_GL883587|taxid562981 .........-..-...------------
      Gemella_sanguinis_M325_acqcz_supercont2_3_whole_genome_shotgun_sequence|NZ_ACRY02000003_306_1866|NZ_ACRY02000003|taxid562983 .........-..-...------------
                         Gemella_sanguinis_strain_PTE3_16S_ribosomal_RNA_gene_partial_sequence|GU561409_1_1442|GU561409|taxid84135 G.AT.....-..-...------------
                         Gemella_sanguinis_gene_for_16S_rRNA_partial_sequence_strain_NTUH_8428|AB775575_1_1311|AB775575|taxid84135 ..AT.....-..-...------------
                                     Gemella_sanguinis_16S_ribosomal_RNA_gene_partial_sequence|AY757357_1_1389|AY757357|taxid84135 ..AT.....C..C...C---C-------
                         Gemella_sanguinis_gene_for_16S_rRNA_partial_sequence_strain_NTUH_2000|AB775572_1_1311|AB775572|taxid84135 .........-..-...------------
                                                                             sv_104_m26n715_s503|781|Gemella_haemolysans_sanguinis .........-..-...------------
```

DONE: Also note that AJ534689 is poor quality and should be excluded.


## Fenollaria massiliensis/timonensis

```{r results='asis'}
list_matching('Fenollaria massiliensis/timonensis')
```

All 100% identical in sequences region!

## Megasphaera

```{r results='asis'}
list_matching('Megasphaera')
```

```
aln output-gethits-2017-09-14/genus/Megasphaera 377,819

                                                                                                                                   # 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
                                                                                                                                   # 3333334444444444444444444444444444444444444445555555555556666666666666666666666666666666666666677777777777777777888
                                                                                                                                   # 7778880033334445555666677788888888889999999990000001112260111112223333334455555566677777788888900033344566777779001
                                                                                                                                   # 7890132923692391789678948901234567890134567890123456790982567890160236782601467803423456905679908925648715134569082
      Megasphaera_sp_NP3_genomic_scaffold_scaffold00017_whole_genome_shotgun_sequence|NZ_HF954548_3587_5142|NZ_HF954548|taxid1232428 .....A....TATTAC-..GCCAAC.C.....A.AGT-ACTG.TC....G.TGGACGC.C.T...TGTTACTACTTATC-CTGCA...-TGCAAT.ACGGT..GA-GTGT.GT.A
      Megasphaera_sp_NP3_genomic_scaffold_scaffold00002_whole_genome_shotgun_sequence|NZ_HF954533_3582_5043|NZ_HF954533|taxid1232428 ........ACT.....-.T...T.CA.GCATCG.T.A-.....GGTG.CTT........A...C...............-...T....-CG..............-.........
                   Megasphaera_massiliensis_strain_NP3_16S_ribosomal_RNA_gene_partial_sequence|JX424772_1_1519|JX424772|taxid1232428 ........ACT.....-.T...T.CA.GGCATC...T......GGTG.CTT........A...C...............-...T....-CG..............-.........
                                        Megasphaera_hominis_16S_ribosomal_RNA_gene_partial_sequence|L79909_1_1522|L79909|taxid159836 ........ACT.....-.T..........C.AC...C......G..G............G...................-...C..T.-................-.........
Megasphaera_micronuciformis_F0359_genomic_scaffold_Scfld25_whole_genome_shotgun_sequence|NZ_GL538193_50_1604|NZ_GL538193|taxid706434 ......GC........-........AA.C.T.....T........A.G..............T..T............-T.TG.....C................-...A...G.
          Megasphaera_micronuciformis_strain_AIP_412_00_16S_ribosomal_RNA_gene_partial_sequence|AF473834_1_1411|AF473834|taxid187326 ......GC........-........AA.C.T.....T........A.G..............T..T............-T.TG.....C................T...A...G.
           Megasphaera_micronuciformis_strain_OTFN_20_2_16S_ribosomal_RNA_gene_partial_sequence|KC632239_1_1415|KC632239|taxid187326 ......GC........-........A..C.T.....T........G.G..............T..T............-T.TG.....C................-...A...G.
                                Megasphaera_genomosp_C1_16S_ribosomal_RNA_gene_partial_sequence|AY278622_1_1525|AY278622|taxid230139 ......GC........-........A..C.T.....T........G.G..............T..T............-T.TG.....C................-...A...G.
                                                                                    Megasphaera_genomosp_type_1|113s1-4||taxid699192 -----......AT.A.-A......AAAGGC..AT.CC.C.GTATC.G.CC........T.CG...T.............-..GTCG.A-TG...........G..-.....GT.A
                                                                                    Megasphaera_genomosp_type_1|127Q-19||taxid699192 -----......AT.A.-.......AAAG.C..AT.CC.C.GTATC.G.CC........T.CG...T.............-..GTCG.A-TG...........G..-.....GT.A
  Megasphaera_genomosp_type_1_str_28L_contig00059_whole_genome_shotgun_sequence|NZ_ADGP01000010_162_1734|NZ_ADGP01000010|taxid699218 ...........AT.A.A.......AAAG.C..AT.CC.C.GTATC.G.CC........T.CG...T.............-..GTCG.A-TG...........G..-.....GT.A
                                                                                           Megasphaera_sp_type_2|7BVA-22||taxid906_2 -----.......T.A.-..........C.A......A...G.......G.........T..TT................-....A.GA-TG...........G..-.....GT.A
                                                                                       Megasphaera_sp_type_2|3025-338F-4||taxid906_2 ............T.A.-.......C..C.A......A...G.......G.........T..TT................-....A.GA-TG...........G..-.....GT.A
                                                                                      Megasphaera_sp_type_2|3025-189R-21||taxid906_2 ............T.A.-.......C..C.A......A...G.......G.........T..TT................-....A.GA-TG...........G..-.....GT.A
                                                                                         Megasphaera_sp_type_2|123b-13-f||taxid906_2 ............T.A.-.......C..C.A......A...G.......G.........T..TT................-....A.GA-TG...........G..-.....GT.A
                                                                                      Megasphaera_sp_type_2|123b-189R-13||taxid906_2 ............T.A.-.......C..C.A......A...G.......G.........T..TT................-....A.GA-TG...........G..-.....GT.A
                           Megasphaera_elsdenii_strain_702_16S_ribosomal_RNA_gene_partial_sequence|JX629265_1_1480|JX629265|taxid907 ........ACT.....-.T........CG.AAC...C......G.T.C...........G...................-...C..T.-................-.........
                         Megasphaera_elsdenii_gene_for_16S_ribosomal_RNA_partial_sequence_strain_3|AB298908_1_1205|AB298908|taxid907 ........ACT.....-.T..........C.AC...C......G..G............G...................-...C..T.-................-.........
                          Megasphaera_elsdenii_strain_La03_16S_ribosomal_RNA_gene_partial_sequence|AF283705_1_1513|AF283705|taxid907 ........ACT.....-.T.........G.AAC...C......G.TR............G...................-...C..T.-................-.........
                         Megasphaera_elsdenii_strain_AW106_16S_ribosomal_RNA_gene_partial_sequence|AY038994_1_1507|AY038994|taxid907 ........ACT.....-.T........CG.A.C...C......G.T.CG..........G...................-...C..T.-................-.........
                                       Megasphaera_elsdenii_14_14_complete_genome|NZ_CP009240_541442_543010|NZ_CP009240|taxid1458465 ........ACT.....-.T........CG.A.C...C......G.T.CG..........G...................-...C..T.-................-.........
                                                                                                 sv_136_m26n704_s503|407|Megasphaera ......GC........-A........TAGGCA....T........GCGT.........T.CA..CT.............-..GCTG.A-......A.....T...-...AC..G.
                                                                                                 sv_184_m26n703_s510|152|Megasphaera ......GC........-........AA.C.T.....T........G.G..............T..T............-T.TG.....C................-...A...G.
                                                                                                  sv_270_m26n706_s506|27|Megasphaera T.....GC........-....G..AA..C.T.....T........A.G..............T..T............-T.TG.....C................-...A...G.

```

![Megasphaera](figs/2017-09-14/megasphaera.png)

All three SVs look most similar to Megasphaera micronuciformis,
although it may not be possible to distinguish Megasphaera genomosp
C1. These are clearly *not* Megasphaera sp. type 2.

DONE: removed taxid 230139 (Megasphaera genomosp. C1)

## Ureaplasma

```{r results='asis'}
list_matching('Ureaplasma')
```

```
% aln output-gethits-2017-09-14/species/Ureaplasma_parvum_urealyticum 365,802
                                                                                                                                                     # 000000
                                                                                                                                                     # 345556
                                                                                                                                                     # 979995
                                                                                                                                                     # 225692
  Ureaplasma_parvum_serovar_14_str_ATCC_33697_gcontig_1106438328058_whole_genome_shotgun_sequence|NZ_ABER01000003_116_1652|NZ_ABER01000003|taxid515609 ......
                                             Ureaplasma_parvum_serovar_3_str_ATCC_700970_complete_genome|NC_002162_343913_345449|NC_002162|taxid273119 .A....
                                             Ureaplasma_parvum_serovar_3_str_ATCC_700970_complete_genome|NC_002162_145327_146863|NC_002162|taxid273119 ......
                                                        Ureaplasma_parvum_strain_hebnu3h07_complete_genome|CP021989_200848_202384|CP021989|taxid134821 .A....
Ureaplasma_parvum_serovar_6_str_ATCC_27818_gcontig_1105428157138_whole_genome_shotgun_sequence|NZ_AAZQ01000001_581612_583111|NZ_AAZQ01000001|taxid5198 ......
                                                           Ureaplasma_urealyticum_U26_serovar_14_16S_ribosomal_RNA_gene|U06095_1_1438|U06095|taxid2130 .A..-.
Ureaplasma_urealyticum_serovar_5_str_ATCC_27817_gcontig_1105469453570_whole_genome_shotgun_sequence|NZ_AAZR01000004_76708_78238|NZ_AAZR01000004|taxid5 ..-A.-
                                                              Ureaplasma_urealyticum_7_serovar_1_16S_ribosomal_RNA_gene|U06094_1_1439|U06094|taxid2130 .A....
                                                                               Ureaplasma_urealyticum_16S_ribosomal_RNA|L08642_1_1585|L08642|taxid2130 ......
                                        Ureaplasma_urealyticum_serovar_10_str_ATCC_33699_complete_genome|NC_011374_149403_150935|NC_011374|taxid565575 A.....
                                                                                                sv_050_m26n706_s503|8351|Ureaplasma_parvum_urealyticum ......
```

U parvum and urealyticum appear to be indistinguishable in this region.

TODO: rename genus call to parvum/urealyticum: need a general mechanism for renaming calls in the pipeline.

## unclassified Bacteroidales

```{r results='asis'}
list_matching('unclassified Bacteroidales')
```

```{bash results='asis'}
grep -A 8 sv-112 output-2017-09-14/dedup_sans_censored.fasta
```

![unclassified Bacteroidales](figs/2017-09-14/unclassified_bacteroidales.png)

Leave for now, consider looking for this organism in other data sets.

## Streptococcus

```{r results='asis'}
list_matching('Streptococcus')
```

```{bash}
bin/trim_to output-gethits-2017-09-14/genus/Streptococcus sv_071
```

## Prevotella

```{r results='asis'}
list_matching('Prevotella')
```

![Prevotella](figs/2017-09-14/prevotella.png)

Small number of reads, confirmed in
/fh/fast/fredricks_d/bvdiversity/2017-04-03-project-trichomonas-refset-comparison/output-urogenital-2017-08-03_named-1.0
that a small number of reads in that context were classified as
Prevotella.

## Arcanobacterium

```{r results='asis'}
list_matching('Arcanobacterium')
```

```{bash results='asis'}
grep -A 8 sv-077 output-2017-09-14/dedup_sans_censored.fasta
```

Identical to a previously-submitted isolate: https://www.ncbi.nlm.nih.gov/nucleotide/399933113
 = JX104007.1

- DONE: create taxon "Arcanobacterium vaginal sp. type 1" for vaginal taxonomy
- add this record to /fh/fast/fredricks_d/bvdiversity/ncbi-plus/data/rename_isolates.xlsx
- there are no other close matches in NCBI, but we can look for them in the future

```{bash}
bin/trim_to output-gethits-2017-09-14/genus/Arcanobacterium sv_077
```

## Bulleidia

```{r results='asis'}
list_matching('Bulleidia')
```

## Lawsonella

```{r results='asis'}
list_matching('Lawsonella')
```

## Howardella

```{r results='asis'}
list_matching('Howardella')
```

```
% trim_to output-gethits-2017-09-14/genus/Howardella sv_062
                                                                                                                # 000000000000000
                                                                                                                # 344555666666777
                                                                                                                # 817689112459124
                                                                                                                # 977336091236994
Howardella_ureilytica_strain_GPC_589_16S_ribosomal_RNA_gene_partial_sequence|DQ925472_1_1531|DQ925472|taxid404403 CCGTATATTTAATAA
                                                                              sv_062_m26n706_s503|4299|Howardella GTTCGCGCCCGGCGG
```

```{bash results='asis'}
grep -A 7 sv-062 output-2017-09-14/dedup_sans_censored.fasta
```

- identical to submitted clone https://www.ncbi.nlm.nih.gov/nucleotide/1005651691 (KU726662)
- DONE: create taxon: "Howardella vaginal sp. type 1"
- add to /fh/fast/fredricks_d/bvdiversity/ncbi-plus/data/rename_isolates.xlsx

## Lactobacillus acidophilus

```{r results='asis'}
list_matching('Lactobacillus acidophilus')
```

![Lactobacillus acidophilus](figs/2017-09-14/lactobacillus_acidophilus.png)

This is the "sing" tree (ie, not a consensus of positions). The single
placement is highly confident within a small clade of L acidiphilus,
but there is some ambiguity among L acidophilus and other species
overall.

## Lactobacillus helveticus

```{r results='asis'}
list_matching('Lactobacillus helveticus')
```

![Lactobacillus helveticus](figs/2017-09-14/lactobacillus_helveticus.png)

Note two acidophilus refs that appear with the helveticus...

- KP987308 - https://www.ncbi.nlm.nih.gov/nuccore/KP987308
- AY763430 - https://www.ncbi.nlm.nih.gov/nuccore/AY763430

No basis for removing these

## Proteobacteria

```{r results='asis'}
list_matching('Proteobacteria')
```

```{r results='asis'}
knitr::kable(read.csv('output-2017-09-14-gethits/phylum/Proteobacteria/hits.csv'))
```

# report info

```{bash}
pwd
git --no-pager log -n1
git status
```

Run me interactively:

```
singularity exec -B $(pwd):$(pwd) -W $(pwd) ../singularity/r-reporting-0.3.img R
```

Used to upload screenshots:

```
#!/bin/bash

label="$1"
screenshot="$(ls Screen* | tail -n -1)"

png=$(python <<EOF
import re
label = "$label"
print '_'.join(re.split(r'[^a-zA-Z]+', label.lower())) + '.png'
EOF)

dest=figs/2017-09-14/$png
scp "$screenshot" quoll:/fh/fast/fredricks_d/bvdiversity/project-plate-26/$dest

echo "![$label]($dest)"
echo -n "![$label]($dest)" | pbcopy
```
