nextflow.enable.dsl = 2

params {
    container = "ghcr.io/fhcrc/yapp:latest"
}

profiles {
    standard {
        workDir = "work/"
        resume = true  // null for no resume
        singularity {
            autoMounts = true
            cacheDir = "singularity/"
        }
        params {
            output = "output-nf"
        }
        process {
            container = params.container
            executor = "local"
        }
        executor{
            queueSize = 16
        }
    }
    uw_batch {
        workDir = "s3://molmicro-data/nextflow-workdir/yapp"
        params {
            output = "output-batch"
        }
        process {
            container = params.container
            scratch = "/docker_scratch"
            queue = "molmicro-queue"
            executor = "awsbatch"

            // allocate resources according to labels; see
            // https://www.nextflow.io/docs/latest/config.html#scope-process
            // https://www.nextflow.io/docs/latest/process.html#label
            // https://aws.amazon.com/ec2/instance-types/c5/
        }
        aws {
            region = "us-west-2"
            batch {
                volumes = "/docker_scratch"
                cliPath = "/home/ec2-user/miniconda/bin/aws"
        }
      }
    }
}
