#+PROPERTY: results output
#+PROPERTY: exports results
#+TITLE: Evaluation of 318-placement-specific-mask, one specimen at a time

* overview

** pplacer versions

dev

#+BEGIN_SRC sh
20140123-dev-env/bin/pplacer --version
#+END_SRC

#+RESULTS:
: v1.1.alpha14-99-g35777a8

318-placement-specific-mask

#+BEGIN_SRC sh
20140123-318-env/bin/pplacer --version
#+END_SRC

#+RESULTS:
: v1.1.alpha14-104-gb3ec79a

** specimens

Use a subset of specimens from the cultivation project

#+BEGIN_SRC sh :results output
tail -n+2 data/seq_info.csv | cut -f2 -d, | sort | uniq -c
#+END_SRC

#+RESULTS:
#+begin_example
   1623 j24tr11
   1589 j24tr7
   1539 j24tr8
   1636 j25tr11
   1547 j25tr7
   1702 j27tr4
   1598 j27tr9
   1683 j32tr5
   1599 j32tr9
   1586 j33tr23
#+end_example

Total sequence count

#+BEGIN_SRC sh
grep -c '>' data/seqs.fasta
#+END_SRC

#+RESULTS:
: 16103

Comparisons

| 318  | pplacer 318-placement-specific-mask |
| dev  | pplacer dev                         |
| FT   | Refpkg built with FastTree          |
| RX   | Refpkg built with RAxML             |
| AT   | Align all together                  |
| OSAT | Align one specimen at a time        |

Total numbers of disagreements among pairwise comparisons

#+BEGIN_SRC sh :results output raw
sqlite3 -csv -header output/comparisons.db "select count(*) as tally, round(count(*)*100.0/16103,2) as pct, comparison from comparison group by comparison" | csvlook
#+END_SRC

#+RESULTS:
|-------+------+-------------------------|
| tally |  pct | comparison              |
|-------+------+-------------------------|
|   977 | 6.07 | 318-FT-AT,318-RX-OSAT   |
|  1146 | 7.12 | 318-FT-AT,dev-FT-AT     |
|   977 | 6.07 | 318-FT-AT,dev-RX-AT     |
|   977 | 6.07 | 318-FT-OSAT,318-RX-AT   |
|   977 | 6.07 | 318-FT-OSAT,318-RX-OSAT |
|  1146 | 7.12 | 318-FT-OSAT,dev-FT-AT   |
|   977 | 6.07 | 318-FT-OSAT,dev-RX-AT   |
|   977 | 6.07 | 318-RX-AT,318-FT-AT     |
|  1012 | 6.28 | 318-RX-AT,dev-FT-AT     |
|  1012 | 6.28 | dev-FT-AT,318-RX-OSAT   |
|   825 | 5.12 | dev-FT-OSAT,318-FT-AT   |
|   825 | 5.12 | dev-FT-OSAT,318-FT-OSAT |
|   950 |  5.9 | dev-FT-OSAT,318-RX-AT   |
|   950 |  5.9 | dev-FT-OSAT,318-RX-OSAT |
|   665 | 4.13 | dev-FT-OSAT,dev-FT-AT   |
|   950 |  5.9 | dev-FT-OSAT,dev-RX-AT   |
|  1012 | 6.28 | dev-RX-AT,dev-FT-AT     |
|   977 | 6.07 | dev-RX-OSAT,318-FT-AT   |
|   977 | 6.07 | dev-RX-OSAT,318-FT-OSAT |
|  1012 | 6.28 | dev-RX-OSAT,dev-FT-AT   |
|   950 |  5.9 | dev-RX-OSAT,dev-FT-OSAT |
|-------+------+-------------------------|

So about 4-6% disagreement rate among pairwise comparisons.

Some comparisons had no differences

#+BEGIN_SRC sh
wc -l output/*.csv | grep --color=no ' 1 '
#+END_SRC

#+RESULTS:
:       1 output/318-FT-OSAT--318-FT-AT.csv
:       1 output/318-RX-AT--318-RX-OSAT.csv
:       1 output/318-RX-AT--dev-RX-AT.csv
:       1 output/dev-RX-AT--318-RX-OSAT.csv
:       1 output/dev-RX-OSAT--318-RX-AT.csv
:       1 output/dev-RX-OSAT--318-RX-OSAT.csv
:       1 output/dev-RX-OSAT--dev-RX-AT.csv

* maybe a little easier to look at:

#+BEGIN_SRC python :results output raw
  import csv
  import glob
  from collections import defaultdict
  from itertools import chain

  rows = []
  for fname in glob.glob('output/*--*.csv'):
      with open(fname) as f:
          count = len(list(csv.DictReader(f)))
          L, R = fname.replace('output/', '').replace('.csv','').split('--')
          row = list(chain.from_iterable(zip(L.split('-'), R.split('-'))))
          row.append(str(count))
          rows.append(row)

  for row in sorted(rows):
      print '|%s|' % '|'.join(row)
#+END_SRC

#+RESULTS:
| 318 | 318 | FT | FT | OSAT | AT   |    0 |
| 318 | 318 | FT | RX | AT   | OSAT |  977 |
| 318 | 318 | FT | RX | OSAT | AT   |  977 |
| 318 | 318 | FT | RX | OSAT | OSAT |  977 |
| 318 | 318 | RX | FT | AT   | AT   |  977 |
| 318 | 318 | RX | RX | AT   | OSAT |    0 |
| 318 | dev | FT | FT | AT   | AT   | 1146 |
| 318 | dev | FT | FT | OSAT | AT   | 1146 |
| 318 | dev | FT | RX | AT   | AT   |  977 |
| 318 | dev | FT | RX | OSAT | AT   |  977 |
| 318 | dev | RX | FT | AT   | AT   | 1012 |
| 318 | dev | RX | RX | AT   | AT   |    0 |
| dev | 318 | FT | FT | OSAT | AT   |  825 |
| dev | 318 | FT | FT | OSAT | OSAT |  825 |
| dev | 318 | FT | RX | AT   | OSAT | 1012 |
| dev | 318 | FT | RX | OSAT | AT   |  950 |
| dev | 318 | FT | RX | OSAT | OSAT |  950 |
| dev | 318 | RX | FT | OSAT | AT   |  977 |
| dev | 318 | RX | FT | OSAT | OSAT |  977 |
| dev | 318 | RX | RX | AT   | OSAT |    0 |
| dev | 318 | RX | RX | OSAT | AT   |    0 |
| dev | 318 | RX | RX | OSAT | OSAT |    0 |
| dev | dev | FT | FT | OSAT | AT   |  665 |
| dev | dev | FT | RX | OSAT | AT   |  950 |
| dev | dev | RX | FT | AT   | AT   | 1012 |
| dev | dev | RX | FT | OSAT | AT   | 1012 |
| dev | dev | RX | FT | OSAT | OSAT |  950 |
| dev | dev | RX | RX | OSAT | AT   |    0 |

